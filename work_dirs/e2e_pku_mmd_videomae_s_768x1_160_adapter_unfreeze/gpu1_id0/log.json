

2025-08-11 09:32:08 Train INFO: Using torch version: 2.5.1+cu121, CUDA version: 12.1
2025-08-11 09:32:08 Train INFO: Config: 
annotation_test = 'data/PKU-MMD/pku_test.json'
annotation_train = 'data/PKU-MMD/pku_train.json'
annotation_val = 'data/PKU-MMD/pku_val.json'
block_list = None
chunk_num = 32
class_map = 'data/PKU-MMD/class_map.txt'
dataset = dict(
    test=dict(
        ann_file='data/PKU-MMD/pku_test.json',
        class_map='data/PKU-MMD/class_map.txt',
        data_path='F:/dataset/pku-mmd/rgb',
        feature_stride=1,
        filter_gt=False,
        pipeline=[
            dict(format='avi', type='PrepareVideoInfo'),
            dict(num_threads=4, type='mmaction.DecordInit'),
            dict(
                method='sliding_window',
                num_clips=1,
                scale_factor=1,
                type='LoadFrames'),
            dict(type='mmaction.DecordDecode'),
            dict(scale=(
                -1,
                160,
            ), type='mmaction.Resize'),
            dict(crop_size=160, type='mmaction.CenterCrop'),
            dict(input_format='NCTHW', type='mmaction.FormatShape'),
            dict(keys=[
                'imgs',
            ], type='ConvertToTensor'),
            dict(inputs='imgs', keys=[
                'masks',
            ], type='Collect'),
        ],
        sample_stride=1,
        subset_name='testing',
        test_mode=True,
        type='PkuSlidingDataset',
        window_overlap_ratio=0.5,
        window_size=512),
    train=dict(
        ann_file='data/PKU-MMD/pku_train.json',
        class_map='data/PKU-MMD/class_map.txt',
        data_path='F:/dataset/pku-mmd/rgb',
        feature_stride=1,
        filter_gt=False,
        pipeline=[
            dict(format='avi', type='PrepareVideoInfo'),
            dict(num_threads=6, type='mmaction.DecordInit'),
            dict(
                crop_ratio=[
                    0.9,
                    1.0,
                ],
                method='random_trunc',
                num_clips=1,
                scale_factor=1,
                trunc_len=512,
                trunc_thresh=0.5,
                type='LoadFrames'),
            dict(type='mmaction.DecordDecode'),
            dict(scale=(
                -1,
                182,
            ), type='mmaction.Resize'),
            dict(type='mmaction.RandomResizedCrop'),
            dict(keep_ratio=False, scale=(
                160,
                160,
            ), type='mmaction.Resize'),
            dict(flip_ratio=0.5, type='mmaction.Flip'),
            dict(transforms='default', type='mmaction.ImgAug'),
            dict(type='mmaction.ColorJitter'),
            dict(input_format='NCTHW', type='mmaction.FormatShape'),
            dict(
                keys=[
                    'imgs',
                    'gt_segments',
                    'gt_labels',
                ],
                type='ConvertToTensor'),
            dict(
                inputs='imgs',
                keys=[
                    'masks',
                    'gt_segments',
                    'gt_labels',
                ],
                type='Collect'),
        ],
        sample_stride=1,
        subset_name='training',
        type='PkuPaddingDataset'),
    val=dict(
        ann_file='data/PKU-MMD/pku_val.json',
        class_map='data/PKU-MMD/class_map.txt',
        data_path='F:/dataset/pku-mmd/rgb',
        feature_stride=1,
        filter_gt=False,
        pipeline=[
            dict(format='avi', type='PrepareVideoInfo'),
            dict(num_threads=4, type='mmaction.DecordInit'),
            dict(
                method='sliding_window',
                num_clips=1,
                scale_factor=1,
                type='LoadFrames'),
            dict(type='mmaction.DecordDecode'),
            dict(scale=(
                -1,
                160,
            ), type='mmaction.Resize'),
            dict(crop_size=160, type='mmaction.CenterCrop'),
            dict(input_format='NCTHW', type='mmaction.FormatShape'),
            dict(
                keys=[
                    'imgs',
                    'gt_segments',
                    'gt_labels',
                ],
                type='ConvertToTensor'),
            dict(
                inputs='imgs',
                keys=[
                    'masks',
                    'gt_segments',
                    'gt_labels',
                ],
                type='Collect'),
        ],
        sample_stride=1,
        subset_name='validation',
        type='PkuSlidingDataset',
        window_overlap_ratio=0.5,
        window_size=512))
evaluation = dict(
    ground_truth_filename='data/PKU-MMD/pku_val.json',
    prediction_filename=
    'work_dirs/e2e_pku_mmd_videomae_s_768x1_160_adapter/gpu1_id0/predictions_val.json',
    subset='validation',
    tiou_thresholds=[
        0.1,
        0.3,
        0.5,
        0.7,
        0.9,
    ],
    type='mAP_PKU_MMD')
inference = dict(
    load_from_raw_predictions=False,
    save_raw_prediction=False,
    score_thresh=0.03)
model = dict(
    backbone=dict(
        adapter_index=[
            0,
            1,
            2,
            3,
            4,
            5,
            6,
            7,
            8,
            9,
            10,
            11,
        ],
        adapter_mlp_ratio=0.25,
        custom=dict(
            freeze_backbone=False,
            norm_eval=False,
            post_processing_pipeline=[
                dict(
                    keys=[
                        'feats',
                    ],
                    ops='b n c t -> b c t',
                    reduction='mean',
                    type='Reduce'),
            ]),
        depth=12,
        drop_path_rate=0.1,
        embed_dims=384,
        img_size=160,
        mlp_ratio=4.0,
        num_frames=16,
        num_heads=6,
        patch_size=16,
        pretrained=
        'pretrained/vit-small-p16_videomae-k400-pre_16x4x1_kinetics-400_my.pth',
        qkv_bias=True,
        return_feat_map=True,
        total_frames=512,
        tubelet_size=2,
        type='VisionTransformerAdapter',
        use_mean_pooling=True,
        with_cp=True),
    neck=dict(
        in_channels=512, num_levels=6, out_channels=512, type='FPNIdentity'),
    projection=dict(
        arch=(
            2,
            2,
            5,
        ),
        attn_cfg=dict(n_head=4, n_mha_win_size=-1),
        conv_cfg=dict(kernel_size=3, proj_pdrop=0.0),
        in_channels=384,
        max_seq_len=512,
        norm_cfg=dict(type='LN'),
        out_channels=512,
        path_pdrop=0.1,
        type='Conv1DTransformerProj',
        use_abs_pe=False),
    rpn_head=dict(
        center_sample='radius',
        center_sample_radius=1.5,
        cls_prior_prob=0.01,
        feat_channels=512,
        in_channels=512,
        label_smoothing=0.0,
        loss=dict(
            cls_loss=dict(type='FocalLoss'), reg_loss=dict(type='DIOULoss')),
        loss_normalizer=100,
        loss_normalizer_momentum=0.9,
        num_classes=51,
        num_convs=2,
        prior_generator=dict(
            regression_range=[
                (
                    0,
                    4,
                ),
                (
                    4,
                    8,
                ),
                (
                    8,
                    16,
                ),
                (
                    16,
                    32,
                ),
                (
                    32,
                    64,
                ),
                (
                    64,
                    10000,
                ),
            ],
            strides=[
                1,
                2,
                4,
                8,
                16,
                32,
            ],
            type='PointGenerator'),
        type='ActionFormerHead'),
    type='ActionFormer')
optimizer = dict(
    backbone=dict(
        custom=[
            dict(lr=0.0002, name='adapter', weight_decay=0.05),
            dict(lr=5e-05, name='blocks.10', weight_decay=0.05),
            dict(lr=5e-05, name='blocks.11', weight_decay=0.05),
        ],
        exclude=[
            'backbone',
        ],
        lr=1e-05,
        weight_decay=0.05),
    lr=0.0001,
    paramwise=True,
    type='AdamW',
    weight_decay=0.05)
post_processing = dict(
    nms=dict(
        max_seg_num=1000,
        multiclass=False,
        sigma=0.3,
        use_soft_nms=True,
        voting_thresh=0.6),
    save_dict=True)
scale_factor = 1
scheduler = dict(
    max_epoch=120, type='LinearWarmupCosineAnnealingLR', warmup_epoch=5)
solver = dict(
    amp=True,
    clip_grad_norm=1,
    ema=True,
    fp16_compress=True,
    static_graph=True,
    test=dict(batch_size=4, num_workers=4),
    train=dict(batch_size=16, num_workers=4),
    val=dict(batch_size=16, num_workers=4))
video_dir = 'F:/dataset/pku-mmd/rgb'
window_size = 512
work_dir = 'work_dirs/e2e_pku_mmd_videomae_s_768x1_160_adapter_unfreeze\\gpu1_id0/'
workflow = dict(
    checkpoint_interval=3,
    end_epoch=120,
    logging_interval=5,
    num_sanity_check=0,
    val_eval_interval=3,
    val_loss_interval=3,
    val_start_epoch=3)

2025-08-11 09:32:09 Train INFO: training subset: 831 videos
2025-08-11 09:32:09 Train INFO: validation subset: 111 videos, truncated as 1958 windows.
2025-08-11 09:32:09 Train INFO: testing subset: 132 videos, truncated as 2370 windows.
2025-08-11 09:32:10 Train INFO: Using single GPU training...
2025-08-11 09:32:10 Train INFO: Using Model EMA...
2025-08-11 09:32:10 Train INFO: Using Automatic Mixed Precision...
2025-08-11 09:32:10 Train INFO: GPU Memory: 24.0 GB
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.pos_embed
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.patch_embed.projection.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.patch_embed.projection.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.0.norm1.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.0.norm1.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.0.attn.q_bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.0.attn.v_bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.0.attn.qkv.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.0.attn.proj.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.0.attn.proj.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.0.norm2.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.0.norm2.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.0.mlp.layers.0.0.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.0.mlp.layers.0.0.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.0.mlp.layers.1.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.0.mlp.layers.1.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.0.adapter.gamma
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.0.adapter.dwconv.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.0.adapter.dwconv.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.0.adapter.conv.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.0.adapter.conv.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.0.adapter.down_proj.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.0.adapter.down_proj.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.0.adapter.up_proj.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.0.adapter.up_proj.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.1.norm1.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.1.norm1.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.1.attn.q_bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.1.attn.v_bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.1.attn.qkv.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.1.attn.proj.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.1.attn.proj.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.1.norm2.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.1.norm2.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.1.mlp.layers.0.0.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.1.mlp.layers.0.0.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.1.mlp.layers.1.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.1.mlp.layers.1.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.1.adapter.gamma
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.1.adapter.dwconv.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.1.adapter.dwconv.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.1.adapter.conv.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.1.adapter.conv.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.1.adapter.down_proj.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.1.adapter.down_proj.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.1.adapter.up_proj.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.1.adapter.up_proj.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.2.norm1.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.2.norm1.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.2.attn.q_bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.2.attn.v_bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.2.attn.qkv.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.2.attn.proj.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.2.attn.proj.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.2.norm2.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.2.norm2.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.2.mlp.layers.0.0.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.2.mlp.layers.0.0.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.2.mlp.layers.1.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.2.mlp.layers.1.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.2.adapter.gamma
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.2.adapter.dwconv.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.2.adapter.dwconv.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.2.adapter.conv.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.2.adapter.conv.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.2.adapter.down_proj.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.2.adapter.down_proj.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.2.adapter.up_proj.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.2.adapter.up_proj.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.3.norm1.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.3.norm1.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.3.attn.q_bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.3.attn.v_bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.3.attn.qkv.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.3.attn.proj.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.3.attn.proj.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.3.norm2.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.3.norm2.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.3.mlp.layers.0.0.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.3.mlp.layers.0.0.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.3.mlp.layers.1.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.3.mlp.layers.1.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.3.adapter.gamma
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.3.adapter.dwconv.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.3.adapter.dwconv.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.3.adapter.conv.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.3.adapter.conv.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.3.adapter.down_proj.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.3.adapter.down_proj.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.3.adapter.up_proj.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.3.adapter.up_proj.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.4.norm1.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.4.norm1.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.4.attn.q_bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.4.attn.v_bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.4.attn.qkv.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.4.attn.proj.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.4.attn.proj.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.4.norm2.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.4.norm2.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.4.mlp.layers.0.0.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.4.mlp.layers.0.0.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.4.mlp.layers.1.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.4.mlp.layers.1.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.4.adapter.gamma
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.4.adapter.dwconv.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.4.adapter.dwconv.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.4.adapter.conv.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.4.adapter.conv.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.4.adapter.down_proj.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.4.adapter.down_proj.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.4.adapter.up_proj.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.4.adapter.up_proj.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.5.norm1.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.5.norm1.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.5.attn.q_bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.5.attn.v_bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.5.attn.qkv.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.5.attn.proj.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.5.attn.proj.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.5.norm2.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.5.norm2.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.5.mlp.layers.0.0.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.5.mlp.layers.0.0.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.5.mlp.layers.1.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.5.mlp.layers.1.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.5.adapter.gamma
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.5.adapter.dwconv.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.5.adapter.dwconv.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.5.adapter.conv.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.5.adapter.conv.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.5.adapter.down_proj.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.5.adapter.down_proj.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.5.adapter.up_proj.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.5.adapter.up_proj.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.6.norm1.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.6.norm1.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.6.attn.q_bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.6.attn.v_bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.6.attn.qkv.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.6.attn.proj.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.6.attn.proj.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.6.norm2.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.6.norm2.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.6.mlp.layers.0.0.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.6.mlp.layers.0.0.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.6.mlp.layers.1.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.6.mlp.layers.1.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.6.adapter.gamma
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.6.adapter.dwconv.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.6.adapter.dwconv.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.6.adapter.conv.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.6.adapter.conv.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.6.adapter.down_proj.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.6.adapter.down_proj.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.6.adapter.up_proj.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.6.adapter.up_proj.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.7.norm1.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.7.norm1.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.7.attn.q_bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.7.attn.v_bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.7.attn.qkv.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.7.attn.proj.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.7.attn.proj.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.7.norm2.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.7.norm2.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.7.mlp.layers.0.0.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.7.mlp.layers.0.0.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.7.mlp.layers.1.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.7.mlp.layers.1.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.7.adapter.gamma
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.7.adapter.dwconv.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.7.adapter.dwconv.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.7.adapter.conv.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.7.adapter.conv.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.7.adapter.down_proj.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.7.adapter.down_proj.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.7.adapter.up_proj.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.7.adapter.up_proj.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.8.norm1.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.8.norm1.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.8.attn.q_bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.8.attn.v_bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.8.attn.qkv.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.8.attn.proj.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.8.attn.proj.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.8.norm2.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.8.norm2.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.8.mlp.layers.0.0.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.8.mlp.layers.0.0.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.8.mlp.layers.1.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.8.mlp.layers.1.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.8.adapter.gamma
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.8.adapter.dwconv.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.8.adapter.dwconv.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.8.adapter.conv.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.8.adapter.conv.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.8.adapter.down_proj.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.8.adapter.down_proj.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.8.adapter.up_proj.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.8.adapter.up_proj.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.9.norm1.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.9.norm1.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.9.attn.q_bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.9.attn.v_bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.9.attn.qkv.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.9.attn.proj.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.9.attn.proj.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.9.norm2.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.9.norm2.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.9.mlp.layers.0.0.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.9.mlp.layers.0.0.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.9.mlp.layers.1.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.9.mlp.layers.1.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.9.adapter.gamma
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.9.adapter.dwconv.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.9.adapter.dwconv.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.9.adapter.conv.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.9.adapter.conv.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.9.adapter.down_proj.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.9.adapter.down_proj.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.9.adapter.up_proj.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.9.adapter.up_proj.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.10.norm1.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.10.norm1.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.10.attn.q_bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.10.attn.v_bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.10.attn.qkv.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.10.attn.proj.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.10.attn.proj.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.10.norm2.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.10.norm2.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.10.mlp.layers.0.0.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.10.mlp.layers.0.0.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.10.mlp.layers.1.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.10.mlp.layers.1.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.10.adapter.gamma
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.10.adapter.dwconv.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.10.adapter.dwconv.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.10.adapter.conv.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.10.adapter.conv.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.10.adapter.down_proj.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.10.adapter.down_proj.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.10.adapter.up_proj.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.10.adapter.up_proj.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.11.norm1.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.11.norm1.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.11.attn.q_bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.11.attn.v_bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.11.attn.qkv.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.11.attn.proj.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.11.attn.proj.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.11.norm2.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.11.norm2.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.11.mlp.layers.0.0.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.11.mlp.layers.0.0.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.11.mlp.layers.1.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.11.mlp.layers.1.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.11.adapter.gamma
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.11.adapter.dwconv.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.11.adapter.dwconv.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.11.adapter.conv.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.11.adapter.conv.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.11.adapter.down_proj.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.11.adapter.down_proj.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.11.adapter.up_proj.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.blocks.11.adapter.up_proj.bias
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.fc_norm.weight
2025-08-11 09:32:10 Train INFO: Backbone parameter: model.fc_norm.bias
2025-08-11 09:32:10 Train INFO: Training Starts...

2025-08-11 09:32:10 Train INFO: [Train]: Epoch 0 started (Total iterations: 52)
2025-08-11 09:41:29 Train INFO: [Train]: [000][00005/00051] (11.5%)  Loss=1.6272  cls_loss=0.8681  reg_loss=0.7590  lr_backbone=1.9e-07  lr_det=1.9e-06  GPU=1443MB(alloc)/25254MB(reserved)/16159MB(max)  ETA=4288s  iter_time=559.242s  fwd=3.855s/bwd=50.673s/opt=0.007s
2025-08-11 09:46:22 Train INFO: [Train]: [000][00010/00051] (21.2%)  Loss=1.6351  cls_loss=0.8832  reg_loss=0.7518  lr_backbone=3.9e-07  lr_det=3.9e-06  GPU=1443MB(alloc)/25254MB(reserved)/16159MB(max)  ETA=3176s  iter_time=292.970s
2025-08-11 09:51:26 Train INFO: [Train]: [000][00015/00051] (30.8%)  Loss=1.6662  cls_loss=0.9263  reg_loss=0.7399  lr_backbone=5.8e-07  lr_det=5.8e-06  GPU=1443MB(alloc)/25254MB(reserved)/16159MB(max)  ETA=2601s  iter_time=303.691s
2025-08-11 09:56:39 Train INFO: [Train]: [000][00020/00051] (40.4%)  Loss=1.6710  cls_loss=0.9595  reg_loss=0.7115  lr_backbone=7.7e-07  lr_det=7.7e-06  GPU=1443MB(alloc)/25254MB(reserved)/16159MB(max)  ETA=2169s  iter_time=313.403s
2025-08-11 10:02:37 Train INFO: [Train]: [000][00025/00051] (50.0%)  Loss=1.6092  cls_loss=0.9571  reg_loss=0.6522  lr_backbone=9.7e-07  lr_det=9.7e-06  GPU=1443MB(alloc)/25254MB(reserved)/16159MB(max)  ETA=1827s  iter_time=357.835s
2025-08-11 10:07:10 Train INFO: [Train]: [000][00030/00051] (59.6%)  Loss=1.6146  cls_loss=0.9997  reg_loss=0.6149  lr_backbone=1.2e-06  lr_det=1.2e-05  GPU=1443MB(alloc)/25254MB(reserved)/16159MB(max)  ETA=1423s  iter_time=273.216s
2025-08-11 10:11:47 Train INFO: [Train]: [000][00035/00051] (69.2%)  Loss=1.5723  cls_loss=0.9999  reg_loss=0.5725  lr_backbone=1.4e-06  lr_det=1.4e-05  GPU=1443MB(alloc)/25254MB(reserved)/16159MB(max)  ETA=1057s  iter_time=277.003s
2025-08-11 10:16:54 Train INFO: [Train]: [000][00040/00051] (78.8%)  Loss=1.5410  cls_loss=0.9990  reg_loss=0.5420  lr_backbone=1.5e-06  lr_det=1.5e-05  GPU=1443MB(alloc)/25254MB(reserved)/16159MB(max)  ETA=720s  iter_time=307.221s
2025-08-11 10:21:20 Train INFO: [Train]: [000][00045/00051] (88.5%)  Loss=1.5226  cls_loss=1.0028  reg_loss=0.5198  lr_backbone=1.7e-06  lr_det=1.7e-05  GPU=1443MB(alloc)/25254MB(reserved)/16159MB(max)  ETA=385s  iter_time=265.810s
2025-08-11 10:25:22 Train INFO: [Train]: [000][00050/00051] (98.1%)  Loss=1.5152  cls_loss=1.0115  reg_loss=0.5038  lr_backbone=1.9e-06  lr_det=1.9e-05  GPU=1443MB(alloc)/25254MB(reserved)/16159MB(max)  ETA=63s  iter_time=241.709s
2025-08-11 10:25:39 Train INFO: [Train]: [000][00051/00051] (100.0%)  Loss=1.5078  cls_loss=1.0081  reg_loss=0.4996  lr_backbone=2.0e-06  lr_det=2.0e-05  GPU=1404MB(alloc)/16714MB(reserved)/16159MB(max)  ETA=0s  iter_time=17.234s
2025-08-11 10:25:40 Train INFO: [Train]: Epoch 0 completed in 3210.4s (avg 61.738s/iter)
2025-08-11 10:25:40 Train INFO: [Train]: Final Loss=1.5078
2025-08-11 10:25:40 Train INFO: [Train]: Epoch 1 started (Total iterations: 52)
2025-08-11 10:35:33 Train INFO: [Train]: [001][00005/00051] (11.5%)  Loss=1.3505  cls_loss=1.0122  reg_loss=0.3383  lr_backbone=2.2e-06  lr_det=2.2e-05  GPU=1441MB(alloc)/23952MB(reserved)/16159MB(max)  ETA=4546s  iter_time=592.949s  fwd=36.840s/bwd=10.172s/opt=17.542s
2025-08-11 10:41:21 Train INFO: [Train]: [001][00010/00051] (21.2%)  Loss=1.3498  cls_loss=1.0126  reg_loss=0.3372  lr_backbone=2.4e-06  lr_det=2.4e-05  GPU=1441MB(alloc)/23952MB(reserved)/16159MB(max)  ETA=3509s  iter_time=348.456s
2025-08-11 10:46:49 Train INFO: [Train]: [001][00015/00051] (30.8%)  Loss=1.3285  cls_loss=0.9980  reg_loss=0.3305  lr_backbone=2.6e-06  lr_det=2.6e-05  GPU=1441MB(alloc)/23952MB(reserved)/16159MB(max)  ETA=2855s  iter_time=327.312s
2025-08-11 10:52:15 Train INFO: [Train]: [001][00020/00051] (40.4%)  Loss=1.3148  cls_loss=0.9886  reg_loss=0.3262  lr_backbone=2.8e-06  lr_det=2.8e-05  GPU=1441MB(alloc)/23952MB(reserved)/16159MB(max)  ETA=2354s  iter_time=326.056s
2025-08-11 10:57:45 Train INFO: [Train]: [001][00025/00051] (50.0%)  Loss=1.3169  cls_loss=0.9906  reg_loss=0.3264  lr_backbone=3.0e-06  lr_det=3.0e-05  GPU=1441MB(alloc)/23952MB(reserved)/16159MB(max)  ETA=1925s  iter_time=329.805s
2025-08-11 11:03:19 Train INFO: [Train]: [001][00030/00051] (59.6%)  Loss=1.3222  cls_loss=0.9952  reg_loss=0.3270  lr_backbone=3.2e-06  lr_det=3.2e-05  GPU=1441MB(alloc)/23952MB(reserved)/16159MB(max)  ETA=1530s  iter_time=334.211s
2025-08-11 11:08:55 Train INFO: [Train]: [001][00035/00051] (69.2%)  Loss=1.3187  cls_loss=0.9939  reg_loss=0.3248  lr_backbone=3.4e-06  lr_det=3.4e-05  GPU=1441MB(alloc)/23952MB(reserved)/16159MB(max)  ETA=1153s  iter_time=336.354s
2025-08-11 11:14:15 Train INFO: [Train]: [001][00040/00051] (78.8%)  Loss=1.2965  cls_loss=0.9783  reg_loss=0.3182  lr_backbone=3.6e-06  lr_det=3.6e-05  GPU=1441MB(alloc)/23952MB(reserved)/16159MB(max)  ETA=782s  iter_time=319.764s
2025-08-11 11:19:19 Train INFO: [Train]: [001][00045/00051] (88.5%)  Loss=1.2976  cls_loss=0.9798  reg_loss=0.3178  lr_backbone=3.7e-06  lr_det=3.7e-05  GPU=1441MB(alloc)/23952MB(reserved)/16159MB(max)  ETA=420s  iter_time=303.983s
2025-08-11 11:24:08 Train INFO: [Train]: [001][00050/00051] (98.1%)  Loss=1.2952  cls_loss=0.9780  reg_loss=0.3173  lr_backbone=3.9e-06  lr_det=3.9e-05  GPU=1441MB(alloc)/23952MB(reserved)/16159MB(max)  ETA=69s  iter_time=288.851s
2025-08-11 11:26:59 Train INFO: [Train]: [001][00051/00051] (100.0%)  Loss=1.2964  cls_loss=0.9790  reg_loss=0.3174  lr_backbone=4.0e-06  lr_det=4.0e-05  GPU=1403MB(alloc)/23952MB(reserved)/16159MB(max)  ETA=0s  iter_time=171.674s
2025-08-11 11:27:00 Train INFO: [Train]: Epoch 1 completed in 3680.2s (avg 70.774s/iter)
2025-08-11 11:27:00 Train INFO: [Train]: Final Loss=1.2964
2025-08-11 11:27:00 Train INFO: [Train]: Epoch 2 started (Total iterations: 52)
2025-08-11 11:36:28 Train INFO: [Train]: [002][00005/00051] (11.5%)  Loss=1.1765  cls_loss=0.8977  reg_loss=0.2788  lr_backbone=4.2e-06  lr_det=4.2e-05  GPU=1441MB(alloc)/23952MB(reserved)/16159MB(max)  ETA=4352s  iter_time=567.701s  fwd=34.302s/bwd=9.220s/opt=15.436s
2025-08-11 11:41:42 Train INFO: [Train]: [002][00010/00051] (21.2%)  Loss=1.3091  cls_loss=0.9893  reg_loss=0.3198  lr_backbone=4.4e-06  lr_det=4.4e-05  GPU=1441MB(alloc)/23952MB(reserved)/16159MB(max)  ETA=3287s  iter_time=314.215s
2025-08-11 11:46:55 Train INFO: [Train]: [002][00015/00051] (30.8%)  Loss=1.3182  cls_loss=0.9935  reg_loss=0.3247  lr_backbone=4.6e-06  lr_det=4.6e-05  GPU=1441MB(alloc)/23952MB(reserved)/16159MB(max)  ETA=2689s  iter_time=313.099s
2025-08-11 11:52:06 Train INFO: [Train]: [002][00020/00051] (40.4%)  Loss=1.3029  cls_loss=0.9837  reg_loss=0.3192  lr_backbone=4.8e-06  lr_det=4.8e-05  GPU=1441MB(alloc)/23952MB(reserved)/16159MB(max)  ETA=2223s  iter_time=311.219s
2025-08-11 11:57:17 Train INFO: [Train]: [002][00025/00051] (50.0%)  Loss=1.3109  cls_loss=0.9905  reg_loss=0.3204  lr_backbone=5.0e-06  lr_det=5.0e-05  GPU=1441MB(alloc)/23952MB(reserved)/16159MB(max)  ETA=1817s  iter_time=310.816s
2025-08-11 12:02:30 Train INFO: [Train]: [002][00030/00051] (59.6%)  Loss=1.2961  cls_loss=0.9802  reg_loss=0.3159  lr_backbone=5.2e-06  lr_det=5.2e-05  GPU=1441MB(alloc)/23952MB(reserved)/16159MB(max)  ETA=1442s  iter_time=312.250s
2025-08-11 12:07:42 Train INFO: [Train]: [002][00035/00051] (69.2%)  Loss=1.2985  cls_loss=0.9814  reg_loss=0.3171  lr_backbone=5.4e-06  lr_det=5.4e-05  GPU=1441MB(alloc)/23952MB(reserved)/16159MB(max)  ETA=1085s  iter_time=312.107s
2025-08-11 12:12:54 Train INFO: [Train]: [002][00040/00051] (78.8%)  Loss=1.2968  cls_loss=0.9793  reg_loss=0.3175  lr_backbone=5.6e-06  lr_det=5.6e-05  GPU=1441MB(alloc)/23952MB(reserved)/16159MB(max)  ETA=739s  iter_time=312.270s
2025-08-11 12:17:57 Train INFO: [Train]: [002][00045/00051] (88.5%)  Loss=1.2812  cls_loss=0.9683  reg_loss=0.3129  lr_backbone=5.8e-06  lr_det=5.8e-05  GPU=1441MB(alloc)/23952MB(reserved)/16159MB(max)  ETA=399s  iter_time=303.239s
2025-08-11 12:22:45 Train INFO: [Train]: [002][00050/00051] (98.1%)  Loss=1.2803  cls_loss=0.9676  reg_loss=0.3127  lr_backbone=5.9e-06  lr_det=5.9e-05  GPU=1441MB(alloc)/23952MB(reserved)/16159MB(max)  ETA=66s  iter_time=287.648s
2025-08-11 12:25:36 Train INFO: [Train]: [002][00051/00051] (100.0%)  Loss=1.2809  cls_loss=0.9680  reg_loss=0.3128  lr_backbone=6.0e-06  lr_det=6.0e-05  GPU=1403MB(alloc)/23952MB(reserved)/16159MB(max)  ETA=0s  iter_time=171.609s
2025-08-11 12:25:37 Train INFO: [Train]: Epoch 2 completed in 3517.0s (avg 67.634s/iter)
2025-08-11 12:25:37 Train INFO: [Train]: Final Loss=1.2809
2025-08-11 12:25:38 Train INFO: Checkpoint saved at epoch 2
2025-08-11 12:25:38 Train INFO: [Train]: Epoch 3 started (Total iterations: 52)
2025-08-11 13:21:54 Train INFO: Using torch version: 2.5.1+cu121, CUDA version: 12.1
2025-08-11 13:21:54 Train INFO: Config: 
annotation_test = 'data/PKU-MMD/pku_test.json'
annotation_train = 'data/PKU-MMD/pku_train.json'
annotation_val = 'data/PKU-MMD/pku_val.json'
block_list = None
chunk_num = 32
class_map = 'data/PKU-MMD/class_map.txt'
dataset = dict(
    test=dict(
        ann_file='data/PKU-MMD/pku_test.json',
        class_map='data/PKU-MMD/class_map.txt',
        data_path='F:/dataset/pku-mmd/rgb',
        feature_stride=1,
        filter_gt=False,
        pipeline=[
            dict(format='avi', type='PrepareVideoInfo'),
            dict(num_threads=4, type='mmaction.DecordInit'),
            dict(
                method='sliding_window',
                num_clips=1,
                scale_factor=1,
                type='LoadFrames'),
            dict(type='mmaction.DecordDecode'),
            dict(scale=(
                -1,
                160,
            ), type='mmaction.Resize'),
            dict(crop_size=160, type='mmaction.CenterCrop'),
            dict(input_format='NCTHW', type='mmaction.FormatShape'),
            dict(keys=[
                'imgs',
            ], type='ConvertToTensor'),
            dict(inputs='imgs', keys=[
                'masks',
            ], type='Collect'),
        ],
        sample_stride=1,
        subset_name='testing',
        test_mode=True,
        type='PkuSlidingDataset',
        window_overlap_ratio=0.5,
        window_size=512),
    train=dict(
        ann_file='data/PKU-MMD/pku_train.json',
        class_map='data/PKU-MMD/class_map.txt',
        data_path='F:/dataset/pku-mmd/rgb',
        feature_stride=1,
        filter_gt=False,
        pipeline=[
            dict(format='avi', type='PrepareVideoInfo'),
            dict(num_threads=6, type='mmaction.DecordInit'),
            dict(
                crop_ratio=[
                    0.9,
                    1.0,
                ],
                method='random_trunc',
                num_clips=1,
                scale_factor=1,
                trunc_len=512,
                trunc_thresh=0.5,
                type='LoadFrames'),
            dict(type='mmaction.DecordDecode'),
            dict(scale=(
                -1,
                182,
            ), type='mmaction.Resize'),
            dict(type='mmaction.RandomResizedCrop'),
            dict(keep_ratio=False, scale=(
                160,
                160,
            ), type='mmaction.Resize'),
            dict(flip_ratio=0.5, type='mmaction.Flip'),
            dict(transforms='default', type='mmaction.ImgAug'),
            dict(type='mmaction.ColorJitter'),
            dict(input_format='NCTHW', type='mmaction.FormatShape'),
            dict(
                keys=[
                    'imgs',
                    'gt_segments',
                    'gt_labels',
                ],
                type='ConvertToTensor'),
            dict(
                inputs='imgs',
                keys=[
                    'masks',
                    'gt_segments',
                    'gt_labels',
                ],
                type='Collect'),
        ],
        sample_stride=1,
        subset_name='training',
        type='PkuPaddingDataset'),
    val=dict(
        ann_file='data/PKU-MMD/pku_val.json',
        class_map='data/PKU-MMD/class_map.txt',
        data_path='F:/dataset/pku-mmd/rgb',
        feature_stride=1,
        filter_gt=False,
        pipeline=[
            dict(format='avi', type='PrepareVideoInfo'),
            dict(num_threads=4, type='mmaction.DecordInit'),
            dict(
                method='sliding_window',
                num_clips=1,
                scale_factor=1,
                type='LoadFrames'),
            dict(type='mmaction.DecordDecode'),
            dict(scale=(
                -1,
                160,
            ), type='mmaction.Resize'),
            dict(crop_size=160, type='mmaction.CenterCrop'),
            dict(input_format='NCTHW', type='mmaction.FormatShape'),
            dict(
                keys=[
                    'imgs',
                    'gt_segments',
                    'gt_labels',
                ],
                type='ConvertToTensor'),
            dict(
                inputs='imgs',
                keys=[
                    'masks',
                    'gt_segments',
                    'gt_labels',
                ],
                type='Collect'),
        ],
        sample_stride=1,
        subset_name='validation',
        type='PkuSlidingDataset',
        window_overlap_ratio=0.5,
        window_size=512))
evaluation = dict(
    ground_truth_filename='data/PKU-MMD/pku_val.json',
    prediction_filename=
    'work_dirs/e2e_pku_mmd_videomae_s_768x1_160_adapter/gpu1_id0/predictions_val.json',
    subset='validation',
    tiou_thresholds=[
        0.1,
        0.3,
        0.5,
        0.7,
        0.9,
    ],
    type='mAP_PKU_MMD')
inference = dict(
    load_from_raw_predictions=False,
    save_raw_prediction=False,
    score_thresh=0.03)
model = dict(
    backbone=dict(
        adapter_index=[
            0,
            1,
            2,
            3,
            4,
            5,
            6,
            7,
            8,
            9,
            10,
            11,
        ],
        adapter_mlp_ratio=0.25,
        custom=dict(
            freeze_backbone=False,
            norm_eval=False,
            post_processing_pipeline=[
                dict(
                    keys=[
                        'feats',
                    ],
                    ops='b n c t -> b c t',
                    reduction='mean',
                    type='Reduce'),
            ]),
        depth=12,
        drop_path_rate=0.1,
        embed_dims=384,
        img_size=160,
        mlp_ratio=4.0,
        num_frames=16,
        num_heads=6,
        patch_size=16,
        pretrained=
        'pretrained/vit-small-p16_videomae-k400-pre_16x4x1_kinetics-400_my.pth',
        qkv_bias=True,
        return_feat_map=True,
        total_frames=512,
        tubelet_size=2,
        type='VisionTransformerAdapter',
        use_mean_pooling=True,
        with_cp=True),
    neck=dict(
        in_channels=512, num_levels=6, out_channels=512, type='FPNIdentity'),
    projection=dict(
        arch=(
            2,
            2,
            5,
        ),
        attn_cfg=dict(n_head=4, n_mha_win_size=-1),
        conv_cfg=dict(kernel_size=3, proj_pdrop=0.0),
        in_channels=384,
        max_seq_len=512,
        norm_cfg=dict(type='LN'),
        out_channels=512,
        path_pdrop=0.1,
        type='Conv1DTransformerProj',
        use_abs_pe=False),
    rpn_head=dict(
        center_sample='radius',
        center_sample_radius=1.5,
        cls_prior_prob=0.01,
        feat_channels=512,
        in_channels=512,
        label_smoothing=0.0,
        loss=dict(
            cls_loss=dict(type='FocalLoss'), reg_loss=dict(type='DIOULoss')),
        loss_normalizer=100,
        loss_normalizer_momentum=0.9,
        num_classes=51,
        num_convs=2,
        prior_generator=dict(
            regression_range=[
                (
                    0,
                    4,
                ),
                (
                    4,
                    8,
                ),
                (
                    8,
                    16,
                ),
                (
                    16,
                    32,
                ),
                (
                    32,
                    64,
                ),
                (
                    64,
                    10000,
                ),
            ],
            strides=[
                1,
                2,
                4,
                8,
                16,
                32,
            ],
            type='PointGenerator'),
        type='ActionFormerHead'),
    type='ActionFormer')
optimizer = dict(
    backbone=dict(
        custom=[
            dict(lr=0.0002, name='adapter', weight_decay=0.05),
            dict(lr=5e-05, name='blocks.10', weight_decay=0.05),
            dict(lr=5e-05, name='blocks.11', weight_decay=0.05),
        ],
        exclude=[
            'backbone',
        ],
        lr=1e-05,
        weight_decay=0.05),
    lr=0.0001,
    paramwise=True,
    type='AdamW',
    weight_decay=0.05)
post_processing = dict(
    nms=dict(
        max_seg_num=1000,
        multiclass=False,
        sigma=0.3,
        use_soft_nms=True,
        voting_thresh=0.6),
    save_dict=True)
scale_factor = 1
scheduler = dict(
    max_epoch=120, type='LinearWarmupCosineAnnealingLR', warmup_epoch=5)
solver = dict(
    amp=True,
    clip_grad_norm=1,
    ema=True,
    fp16_compress=True,
    static_graph=True,
    test=dict(batch_size=4, num_workers=4),
    train=dict(batch_size=16, num_workers=4),
    val=dict(batch_size=16, num_workers=4))
video_dir = 'F:/dataset/pku-mmd/rgb'
window_size = 512
work_dir = 'work_dirs/e2e_pku_mmd_videomae_s_768x1_160_adapter_unfreeze\\gpu1_id0/'
workflow = dict(
    checkpoint_interval=3,
    end_epoch=120,
    logging_interval=5,
    num_sanity_check=0,
    val_eval_interval=3,
    val_loss_interval=3,
    val_start_epoch=3)

2025-08-11 13:21:55 Train INFO: training subset: 831 videos
2025-08-11 13:21:55 Train INFO: validation subset: 111 videos, truncated as 1958 windows.
2025-08-11 13:21:55 Train INFO: testing subset: 132 videos, truncated as 2370 windows.
2025-08-11 13:21:55 Train INFO: Using single GPU training...
2025-08-11 13:21:55 Train INFO: Using Model EMA...
2025-08-11 13:21:56 Train INFO: Using Automatic Mixed Precision...
2025-08-11 13:21:56 Train INFO: GPU Memory: 24.0 GB
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.pos_embed
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.patch_embed.projection.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.patch_embed.projection.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.0.norm1.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.0.norm1.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.0.attn.q_bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.0.attn.v_bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.0.attn.qkv.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.0.attn.proj.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.0.attn.proj.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.0.norm2.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.0.norm2.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.0.mlp.layers.0.0.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.0.mlp.layers.0.0.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.0.mlp.layers.1.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.0.mlp.layers.1.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.0.adapter.gamma
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.0.adapter.dwconv.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.0.adapter.dwconv.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.0.adapter.conv.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.0.adapter.conv.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.0.adapter.down_proj.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.0.adapter.down_proj.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.0.adapter.up_proj.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.0.adapter.up_proj.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.1.norm1.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.1.norm1.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.1.attn.q_bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.1.attn.v_bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.1.attn.qkv.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.1.attn.proj.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.1.attn.proj.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.1.norm2.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.1.norm2.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.1.mlp.layers.0.0.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.1.mlp.layers.0.0.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.1.mlp.layers.1.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.1.mlp.layers.1.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.1.adapter.gamma
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.1.adapter.dwconv.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.1.adapter.dwconv.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.1.adapter.conv.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.1.adapter.conv.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.1.adapter.down_proj.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.1.adapter.down_proj.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.1.adapter.up_proj.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.1.adapter.up_proj.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.2.norm1.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.2.norm1.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.2.attn.q_bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.2.attn.v_bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.2.attn.qkv.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.2.attn.proj.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.2.attn.proj.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.2.norm2.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.2.norm2.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.2.mlp.layers.0.0.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.2.mlp.layers.0.0.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.2.mlp.layers.1.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.2.mlp.layers.1.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.2.adapter.gamma
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.2.adapter.dwconv.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.2.adapter.dwconv.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.2.adapter.conv.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.2.adapter.conv.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.2.adapter.down_proj.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.2.adapter.down_proj.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.2.adapter.up_proj.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.2.adapter.up_proj.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.3.norm1.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.3.norm1.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.3.attn.q_bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.3.attn.v_bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.3.attn.qkv.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.3.attn.proj.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.3.attn.proj.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.3.norm2.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.3.norm2.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.3.mlp.layers.0.0.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.3.mlp.layers.0.0.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.3.mlp.layers.1.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.3.mlp.layers.1.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.3.adapter.gamma
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.3.adapter.dwconv.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.3.adapter.dwconv.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.3.adapter.conv.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.3.adapter.conv.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.3.adapter.down_proj.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.3.adapter.down_proj.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.3.adapter.up_proj.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.3.adapter.up_proj.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.4.norm1.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.4.norm1.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.4.attn.q_bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.4.attn.v_bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.4.attn.qkv.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.4.attn.proj.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.4.attn.proj.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.4.norm2.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.4.norm2.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.4.mlp.layers.0.0.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.4.mlp.layers.0.0.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.4.mlp.layers.1.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.4.mlp.layers.1.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.4.adapter.gamma
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.4.adapter.dwconv.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.4.adapter.dwconv.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.4.adapter.conv.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.4.adapter.conv.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.4.adapter.down_proj.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.4.adapter.down_proj.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.4.adapter.up_proj.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.4.adapter.up_proj.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.5.norm1.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.5.norm1.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.5.attn.q_bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.5.attn.v_bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.5.attn.qkv.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.5.attn.proj.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.5.attn.proj.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.5.norm2.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.5.norm2.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.5.mlp.layers.0.0.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.5.mlp.layers.0.0.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.5.mlp.layers.1.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.5.mlp.layers.1.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.5.adapter.gamma
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.5.adapter.dwconv.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.5.adapter.dwconv.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.5.adapter.conv.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.5.adapter.conv.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.5.adapter.down_proj.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.5.adapter.down_proj.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.5.adapter.up_proj.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.5.adapter.up_proj.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.6.norm1.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.6.norm1.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.6.attn.q_bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.6.attn.v_bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.6.attn.qkv.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.6.attn.proj.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.6.attn.proj.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.6.norm2.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.6.norm2.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.6.mlp.layers.0.0.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.6.mlp.layers.0.0.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.6.mlp.layers.1.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.6.mlp.layers.1.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.6.adapter.gamma
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.6.adapter.dwconv.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.6.adapter.dwconv.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.6.adapter.conv.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.6.adapter.conv.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.6.adapter.down_proj.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.6.adapter.down_proj.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.6.adapter.up_proj.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.6.adapter.up_proj.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.7.norm1.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.7.norm1.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.7.attn.q_bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.7.attn.v_bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.7.attn.qkv.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.7.attn.proj.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.7.attn.proj.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.7.norm2.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.7.norm2.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.7.mlp.layers.0.0.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.7.mlp.layers.0.0.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.7.mlp.layers.1.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.7.mlp.layers.1.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.7.adapter.gamma
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.7.adapter.dwconv.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.7.adapter.dwconv.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.7.adapter.conv.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.7.adapter.conv.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.7.adapter.down_proj.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.7.adapter.down_proj.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.7.adapter.up_proj.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.7.adapter.up_proj.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.8.norm1.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.8.norm1.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.8.attn.q_bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.8.attn.v_bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.8.attn.qkv.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.8.attn.proj.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.8.attn.proj.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.8.norm2.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.8.norm2.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.8.mlp.layers.0.0.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.8.mlp.layers.0.0.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.8.mlp.layers.1.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.8.mlp.layers.1.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.8.adapter.gamma
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.8.adapter.dwconv.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.8.adapter.dwconv.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.8.adapter.conv.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.8.adapter.conv.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.8.adapter.down_proj.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.8.adapter.down_proj.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.8.adapter.up_proj.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.8.adapter.up_proj.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.9.norm1.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.9.norm1.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.9.attn.q_bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.9.attn.v_bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.9.attn.qkv.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.9.attn.proj.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.9.attn.proj.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.9.norm2.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.9.norm2.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.9.mlp.layers.0.0.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.9.mlp.layers.0.0.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.9.mlp.layers.1.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.9.mlp.layers.1.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.9.adapter.gamma
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.9.adapter.dwconv.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.9.adapter.dwconv.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.9.adapter.conv.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.9.adapter.conv.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.9.adapter.down_proj.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.9.adapter.down_proj.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.9.adapter.up_proj.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.9.adapter.up_proj.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.10.norm1.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.10.norm1.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.10.attn.q_bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.10.attn.v_bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.10.attn.qkv.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.10.attn.proj.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.10.attn.proj.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.10.norm2.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.10.norm2.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.10.mlp.layers.0.0.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.10.mlp.layers.0.0.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.10.mlp.layers.1.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.10.mlp.layers.1.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.10.adapter.gamma
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.10.adapter.dwconv.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.10.adapter.dwconv.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.10.adapter.conv.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.10.adapter.conv.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.10.adapter.down_proj.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.10.adapter.down_proj.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.10.adapter.up_proj.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.10.adapter.up_proj.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.11.norm1.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.11.norm1.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.11.attn.q_bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.11.attn.v_bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.11.attn.qkv.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.11.attn.proj.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.11.attn.proj.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.11.norm2.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.11.norm2.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.11.mlp.layers.0.0.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.11.mlp.layers.0.0.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.11.mlp.layers.1.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.11.mlp.layers.1.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.11.adapter.gamma
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.11.adapter.dwconv.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.11.adapter.dwconv.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.11.adapter.conv.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.11.adapter.conv.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.11.adapter.down_proj.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.11.adapter.down_proj.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.11.adapter.up_proj.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.blocks.11.adapter.up_proj.bias
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.fc_norm.weight
2025-08-11 13:21:56 Train INFO: Backbone parameter: model.fc_norm.bias
2025-08-11 13:21:56 Train INFO: Resume training from: work_dirs/e2e_pku_mmd_videomae_s_768x1_160_adapter_unfreeze/gpu1_id0/checkpoint/epoch_2.pth
2025-08-11 13:21:56 Train INFO: Resume epoch is 2
2025-08-11 13:21:56 Train INFO: Training Starts...

2025-08-11 13:21:56 Train INFO: [Train]: Epoch 3 started (Total iterations: 52)
2025-08-11 13:33:14 Train INFO: [Train]: [003][00005/00051] (11.5%)  Loss=1.4254  cls_loss=1.0676  reg_loss=0.3579  lr_backbone=6.2e-06  lr_det=6.2e-05  GPU=1441MB(alloc)/25434MB(reserved)/16157MB(max)  ETA=5196s  iter_time=677.770s  fwd=3.830s/bwd=53.988s/opt=0.016s
2025-08-11 13:38:26 Train INFO: [Train]: [003][00010/00051] (21.2%)  Loss=1.3361  cls_loss=1.0058  reg_loss=0.3303  lr_backbone=6.4e-06  lr_det=6.4e-05  GPU=1441MB(alloc)/25434MB(reserved)/16157MB(max)  ETA=3692s  iter_time=312.673s
2025-08-11 13:43:33 Train INFO: [Train]: [003][00015/00051] (30.8%)  Loss=1.3105  cls_loss=0.9876  reg_loss=0.3230  lr_backbone=6.6e-06  lr_det=6.6e-05  GPU=1441MB(alloc)/25434MB(reserved)/16157MB(max)  ETA=2919s  iter_time=306.867s
2025-08-11 13:47:32 Train INFO: Using torch version: 2.5.1+cu121, CUDA version: 12.1
2025-08-11 13:47:33 Train INFO: Config: 
annotation_test = 'data/PKU-MMD/pku_test.json'
annotation_train = 'data/PKU-MMD/pku_train.json'
annotation_val = 'data/PKU-MMD/pku_val.json'
block_list = None
chunk_num = 32
class_map = 'data/PKU-MMD/class_map.txt'
dataset = dict(
    test=dict(
        ann_file='data/PKU-MMD/pku_test.json',
        class_map='data/PKU-MMD/class_map.txt',
        data_path='F:/dataset/pku-mmd/rgb',
        feature_stride=1,
        filter_gt=False,
        pipeline=[
            dict(format='avi', type='PrepareVideoInfo'),
            dict(num_threads=4, type='mmaction.DecordInit'),
            dict(
                method='sliding_window',
                num_clips=1,
                scale_factor=1,
                type='LoadFrames'),
            dict(type='mmaction.DecordDecode'),
            dict(scale=(
                -1,
                160,
            ), type='mmaction.Resize'),
            dict(crop_size=160, type='mmaction.CenterCrop'),
            dict(input_format='NCTHW', type='mmaction.FormatShape'),
            dict(keys=[
                'imgs',
            ], type='ConvertToTensor'),
            dict(inputs='imgs', keys=[
                'masks',
            ], type='Collect'),
        ],
        sample_stride=1,
        subset_name='testing',
        test_mode=True,
        type='PkuSlidingDataset',
        window_overlap_ratio=0.5,
        window_size=512),
    train=dict(
        ann_file='data/PKU-MMD/pku_train.json',
        class_map='data/PKU-MMD/class_map.txt',
        data_path='F:/dataset/pku-mmd/rgb',
        feature_stride=1,
        filter_gt=False,
        pipeline=[
            dict(format='avi', type='PrepareVideoInfo'),
            dict(num_threads=6, type='mmaction.DecordInit'),
            dict(
                crop_ratio=[
                    0.9,
                    1.0,
                ],
                method='random_trunc',
                num_clips=1,
                scale_factor=1,
                trunc_len=512,
                trunc_thresh=0.5,
                type='LoadFrames'),
            dict(type='mmaction.DecordDecode'),
            dict(scale=(
                -1,
                182,
            ), type='mmaction.Resize'),
            dict(type='mmaction.RandomResizedCrop'),
            dict(keep_ratio=False, scale=(
                160,
                160,
            ), type='mmaction.Resize'),
            dict(flip_ratio=0.5, type='mmaction.Flip'),
            dict(transforms='default', type='mmaction.ImgAug'),
            dict(type='mmaction.ColorJitter'),
            dict(input_format='NCTHW', type='mmaction.FormatShape'),
            dict(
                keys=[
                    'imgs',
                    'gt_segments',
                    'gt_labels',
                ],
                type='ConvertToTensor'),
            dict(
                inputs='imgs',
                keys=[
                    'masks',
                    'gt_segments',
                    'gt_labels',
                ],
                type='Collect'),
        ],
        sample_stride=1,
        subset_name='training',
        type='PkuPaddingDataset'),
    val=dict(
        ann_file='data/PKU-MMD/pku_val.json',
        class_map='data/PKU-MMD/class_map.txt',
        data_path='F:/dataset/pku-mmd/rgb',
        feature_stride=1,
        filter_gt=False,
        pipeline=[
            dict(format='avi', type='PrepareVideoInfo'),
            dict(num_threads=4, type='mmaction.DecordInit'),
            dict(
                method='sliding_window',
                num_clips=1,
                scale_factor=1,
                type='LoadFrames'),
            dict(type='mmaction.DecordDecode'),
            dict(scale=(
                -1,
                160,
            ), type='mmaction.Resize'),
            dict(crop_size=160, type='mmaction.CenterCrop'),
            dict(input_format='NCTHW', type='mmaction.FormatShape'),
            dict(
                keys=[
                    'imgs',
                    'gt_segments',
                    'gt_labels',
                ],
                type='ConvertToTensor'),
            dict(
                inputs='imgs',
                keys=[
                    'masks',
                    'gt_segments',
                    'gt_labels',
                ],
                type='Collect'),
        ],
        sample_stride=1,
        subset_name='validation',
        type='PkuSlidingDataset',
        window_overlap_ratio=0.5,
        window_size=512))
evaluation = dict(
    ground_truth_filename='data/PKU-MMD/pku_val.json',
    prediction_filename=
    'work_dirs/e2e_pku_mmd_videomae_s_768x1_160_adapter/gpu1_id0/predictions_val.json',
    subset='validation',
    tiou_thresholds=[
        0.2,
        0.3,
        0.4,
        0.5,
        0.6,
    ],
    type='mAP_PKU_MMD')
inference = dict(
    load_from_raw_predictions=False,
    save_raw_prediction=False,
    score_thresh=0.03)
model = dict(
    backbone=dict(
        adapter_index=[
            0,
            1,
            2,
            3,
            4,
            5,
            6,
            7,
            8,
            9,
            10,
            11,
        ],
        adapter_mlp_ratio=0.25,
        custom=dict(
            freeze_backbone=False,
            norm_eval=False,
            post_processing_pipeline=[
                dict(
                    keys=[
                        'feats',
                    ],
                    ops='b n c t -> b c t',
                    reduction='mean',
                    type='Reduce'),
            ]),
        depth=12,
        drop_path_rate=0.1,
        embed_dims=384,
        img_size=160,
        mlp_ratio=4.0,
        num_frames=16,
        num_heads=6,
        patch_size=16,
        pretrained=
        'pretrained/vit-small-p16_videomae-k400-pre_16x4x1_kinetics-400_my.pth',
        qkv_bias=True,
        return_feat_map=True,
        total_frames=512,
        tubelet_size=2,
        type='VisionTransformerAdapter',
        use_mean_pooling=True,
        with_cp=True),
    neck=dict(
        in_channels=512, num_levels=6, out_channels=512, type='FPNIdentity'),
    projection=dict(
        arch=(
            2,
            2,
            5,
        ),
        attn_cfg=dict(n_head=4, n_mha_win_size=-1),
        conv_cfg=dict(kernel_size=3, proj_pdrop=0.0),
        in_channels=384,
        max_seq_len=512,
        norm_cfg=dict(type='LN'),
        out_channels=512,
        path_pdrop=0.1,
        type='Conv1DTransformerProj',
        use_abs_pe=False),
    rpn_head=dict(
        center_sample='radius',
        center_sample_radius=1.5,
        cls_prior_prob=0.01,
        feat_channels=512,
        in_channels=512,
        label_smoothing=0.0,
        loss=dict(
            cls_loss=dict(type='FocalLoss'), reg_loss=dict(type='DIOULoss')),
        loss_normalizer=100,
        loss_normalizer_momentum=0.9,
        num_classes=51,
        num_convs=2,
        prior_generator=dict(
            regression_range=[
                (
                    0,
                    4,
                ),
                (
                    4,
                    8,
                ),
                (
                    8,
                    16,
                ),
                (
                    16,
                    32,
                ),
                (
                    32,
                    64,
                ),
                (
                    64,
                    10000,
                ),
            ],
            strides=[
                1,
                2,
                4,
                8,
                16,
                32,
            ],
            type='PointGenerator'),
        type='ActionFormerHead'),
    type='ActionFormer')
optimizer = dict(
    backbone=dict(
        custom=[
            dict(lr=0.0002, name='adapter', weight_decay=0.05),
            dict(lr=5e-05, name='blocks.10', weight_decay=0.05),
            dict(lr=5e-05, name='blocks.11', weight_decay=0.05),
        ],
        exclude=[
            'backbone',
        ],
        lr=1e-05,
        weight_decay=0.05),
    lr=0.0001,
    paramwise=True,
    type='AdamW',
    weight_decay=0.05)
post_processing = dict(
    nms=dict(
        max_seg_num=1000,
        multiclass=False,
        sigma=0.3,
        use_soft_nms=True,
        voting_thresh=0.6),
    save_dict=True)
scale_factor = 1
scheduler = dict(
    max_epoch=120, type='LinearWarmupCosineAnnealingLR', warmup_epoch=5)
solver = dict(
    amp=True,
    clip_grad_norm=1,
    ema=True,
    fp16_compress=True,
    static_graph=True,
    test=dict(batch_size=4, num_workers=4),
    train=dict(batch_size=16, num_workers=4),
    val=dict(batch_size=16, num_workers=4))
video_dir = 'F:/dataset/pku-mmd/rgb'
window_size = 512
work_dir = 'work_dirs/e2e_pku_mmd_videomae_s_768x1_160_adapter_unfreeze\\gpu1_id0/'
workflow = dict(
    checkpoint_interval=3,
    end_epoch=120,
    logging_interval=5,
    num_sanity_check=0,
    val_eval_interval=3,
    val_loss_interval=3,
    val_start_epoch=3)

2025-08-11 13:47:33 Train INFO: training subset: 831 videos
2025-08-11 13:47:33 Train INFO: validation subset: 111 videos, truncated as 1958 windows.
2025-08-11 13:47:33 Train INFO: testing subset: 132 videos, truncated as 2370 windows.
2025-08-11 13:47:34 Train INFO: Using single GPU training...
2025-08-11 13:47:34 Train INFO: Using Model EMA...
2025-08-11 13:47:34 Train INFO: Using Automatic Mixed Precision...
2025-08-11 13:47:34 Train INFO: GPU Memory: 24.0 GB
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.pos_embed
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.patch_embed.projection.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.patch_embed.projection.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.0.norm1.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.0.norm1.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.0.attn.q_bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.0.attn.v_bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.0.attn.qkv.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.0.attn.proj.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.0.attn.proj.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.0.norm2.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.0.norm2.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.0.mlp.layers.0.0.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.0.mlp.layers.0.0.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.0.mlp.layers.1.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.0.mlp.layers.1.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.0.adapter.gamma
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.0.adapter.dwconv.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.0.adapter.dwconv.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.0.adapter.conv.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.0.adapter.conv.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.0.adapter.down_proj.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.0.adapter.down_proj.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.0.adapter.up_proj.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.0.adapter.up_proj.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.1.norm1.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.1.norm1.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.1.attn.q_bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.1.attn.v_bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.1.attn.qkv.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.1.attn.proj.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.1.attn.proj.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.1.norm2.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.1.norm2.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.1.mlp.layers.0.0.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.1.mlp.layers.0.0.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.1.mlp.layers.1.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.1.mlp.layers.1.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.1.adapter.gamma
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.1.adapter.dwconv.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.1.adapter.dwconv.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.1.adapter.conv.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.1.adapter.conv.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.1.adapter.down_proj.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.1.adapter.down_proj.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.1.adapter.up_proj.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.1.adapter.up_proj.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.2.norm1.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.2.norm1.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.2.attn.q_bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.2.attn.v_bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.2.attn.qkv.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.2.attn.proj.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.2.attn.proj.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.2.norm2.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.2.norm2.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.2.mlp.layers.0.0.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.2.mlp.layers.0.0.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.2.mlp.layers.1.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.2.mlp.layers.1.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.2.adapter.gamma
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.2.adapter.dwconv.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.2.adapter.dwconv.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.2.adapter.conv.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.2.adapter.conv.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.2.adapter.down_proj.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.2.adapter.down_proj.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.2.adapter.up_proj.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.2.adapter.up_proj.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.3.norm1.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.3.norm1.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.3.attn.q_bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.3.attn.v_bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.3.attn.qkv.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.3.attn.proj.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.3.attn.proj.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.3.norm2.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.3.norm2.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.3.mlp.layers.0.0.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.3.mlp.layers.0.0.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.3.mlp.layers.1.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.3.mlp.layers.1.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.3.adapter.gamma
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.3.adapter.dwconv.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.3.adapter.dwconv.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.3.adapter.conv.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.3.adapter.conv.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.3.adapter.down_proj.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.3.adapter.down_proj.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.3.adapter.up_proj.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.3.adapter.up_proj.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.4.norm1.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.4.norm1.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.4.attn.q_bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.4.attn.v_bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.4.attn.qkv.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.4.attn.proj.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.4.attn.proj.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.4.norm2.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.4.norm2.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.4.mlp.layers.0.0.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.4.mlp.layers.0.0.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.4.mlp.layers.1.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.4.mlp.layers.1.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.4.adapter.gamma
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.4.adapter.dwconv.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.4.adapter.dwconv.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.4.adapter.conv.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.4.adapter.conv.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.4.adapter.down_proj.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.4.adapter.down_proj.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.4.adapter.up_proj.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.4.adapter.up_proj.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.5.norm1.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.5.norm1.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.5.attn.q_bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.5.attn.v_bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.5.attn.qkv.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.5.attn.proj.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.5.attn.proj.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.5.norm2.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.5.norm2.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.5.mlp.layers.0.0.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.5.mlp.layers.0.0.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.5.mlp.layers.1.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.5.mlp.layers.1.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.5.adapter.gamma
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.5.adapter.dwconv.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.5.adapter.dwconv.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.5.adapter.conv.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.5.adapter.conv.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.5.adapter.down_proj.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.5.adapter.down_proj.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.5.adapter.up_proj.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.5.adapter.up_proj.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.6.norm1.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.6.norm1.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.6.attn.q_bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.6.attn.v_bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.6.attn.qkv.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.6.attn.proj.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.6.attn.proj.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.6.norm2.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.6.norm2.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.6.mlp.layers.0.0.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.6.mlp.layers.0.0.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.6.mlp.layers.1.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.6.mlp.layers.1.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.6.adapter.gamma
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.6.adapter.dwconv.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.6.adapter.dwconv.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.6.adapter.conv.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.6.adapter.conv.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.6.adapter.down_proj.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.6.adapter.down_proj.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.6.adapter.up_proj.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.6.adapter.up_proj.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.7.norm1.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.7.norm1.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.7.attn.q_bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.7.attn.v_bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.7.attn.qkv.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.7.attn.proj.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.7.attn.proj.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.7.norm2.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.7.norm2.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.7.mlp.layers.0.0.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.7.mlp.layers.0.0.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.7.mlp.layers.1.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.7.mlp.layers.1.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.7.adapter.gamma
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.7.adapter.dwconv.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.7.adapter.dwconv.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.7.adapter.conv.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.7.adapter.conv.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.7.adapter.down_proj.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.7.adapter.down_proj.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.7.adapter.up_proj.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.7.adapter.up_proj.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.8.norm1.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.8.norm1.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.8.attn.q_bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.8.attn.v_bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.8.attn.qkv.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.8.attn.proj.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.8.attn.proj.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.8.norm2.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.8.norm2.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.8.mlp.layers.0.0.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.8.mlp.layers.0.0.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.8.mlp.layers.1.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.8.mlp.layers.1.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.8.adapter.gamma
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.8.adapter.dwconv.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.8.adapter.dwconv.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.8.adapter.conv.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.8.adapter.conv.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.8.adapter.down_proj.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.8.adapter.down_proj.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.8.adapter.up_proj.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.8.adapter.up_proj.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.9.norm1.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.9.norm1.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.9.attn.q_bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.9.attn.v_bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.9.attn.qkv.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.9.attn.proj.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.9.attn.proj.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.9.norm2.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.9.norm2.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.9.mlp.layers.0.0.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.9.mlp.layers.0.0.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.9.mlp.layers.1.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.9.mlp.layers.1.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.9.adapter.gamma
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.9.adapter.dwconv.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.9.adapter.dwconv.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.9.adapter.conv.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.9.adapter.conv.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.9.adapter.down_proj.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.9.adapter.down_proj.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.9.adapter.up_proj.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.9.adapter.up_proj.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.10.norm1.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.10.norm1.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.10.attn.q_bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.10.attn.v_bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.10.attn.qkv.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.10.attn.proj.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.10.attn.proj.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.10.norm2.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.10.norm2.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.10.mlp.layers.0.0.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.10.mlp.layers.0.0.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.10.mlp.layers.1.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.10.mlp.layers.1.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.10.adapter.gamma
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.10.adapter.dwconv.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.10.adapter.dwconv.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.10.adapter.conv.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.10.adapter.conv.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.10.adapter.down_proj.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.10.adapter.down_proj.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.10.adapter.up_proj.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.10.adapter.up_proj.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.11.norm1.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.11.norm1.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.11.attn.q_bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.11.attn.v_bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.11.attn.qkv.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.11.attn.proj.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.11.attn.proj.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.11.norm2.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.11.norm2.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.11.mlp.layers.0.0.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.11.mlp.layers.0.0.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.11.mlp.layers.1.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.11.mlp.layers.1.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.11.adapter.gamma
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.11.adapter.dwconv.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.11.adapter.dwconv.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.11.adapter.conv.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.11.adapter.conv.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.11.adapter.down_proj.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.11.adapter.down_proj.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.11.adapter.up_proj.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.blocks.11.adapter.up_proj.bias
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.fc_norm.weight
2025-08-11 13:47:34 Train INFO: Backbone parameter: model.fc_norm.bias
2025-08-11 13:47:34 Train INFO: Resume training from: work_dirs/e2e_pku_mmd_videomae_s_768x1_160_adapter_unfreeze/gpu1_id0/checkpoint/epoch_2.pth
2025-08-11 13:47:34 Train INFO: Resume epoch is 2
2025-08-11 13:47:34 Train INFO: Training Starts...

2025-08-11 13:47:34 Train INFO: [Train]: Epoch 3 started (Total iterations: 52)
2025-08-11 13:52:55 Train INFO: [Train]: [003][00005/00051] (11.5%)  Loss=1.4254  cls_loss=1.0676  reg_loss=0.3579  lr_backbone=6.2e-06  lr_det=6.2e-05  GPU=1441MB(alloc)/25434MB(reserved)/16157MB(max)  ETA=2461s  iter_time=320.975s  fwd=3.138s/bwd=33.490s/opt=0.035s
2025-08-11 13:55:56 Train INFO: [Train]: [003][00010/00051] (21.2%)  Loss=1.3361  cls_loss=1.0058  reg_loss=0.3303  lr_backbone=6.4e-06  lr_det=6.4e-05  GPU=1441MB(alloc)/25434MB(reserved)/16157MB(max)  ETA=1872s  iter_time=181.201s
2025-08-11 13:58:53 Train INFO: [Train]: [003][00015/00051] (30.8%)  Loss=1.3105  cls_loss=0.9876  reg_loss=0.3229  lr_backbone=6.6e-06  lr_det=6.6e-05  GPU=1441MB(alloc)/25434MB(reserved)/16157MB(max)  ETA=1529s  iter_time=177.264s
2025-08-11 14:01:39 Train INFO: [Train]: [003][00020/00051] (40.4%)  Loss=1.2991  cls_loss=0.9759  reg_loss=0.3232  lr_backbone=6.8e-06  lr_det=6.8e-05  GPU=1441MB(alloc)/25434MB(reserved)/16157MB(max)  ETA=1247s  iter_time=165.070s
2025-08-11 14:04:16 Train INFO: [Train]: [003][00025/00051] (50.0%)  Loss=1.2566  cls_loss=0.9439  reg_loss=0.3127  lr_backbone=7.0e-06  lr_det=7.0e-05  GPU=1441MB(alloc)/25434MB(reserved)/16157MB(max)  ETA=1002s  iter_time=157.108s
2025-08-11 14:06:55 Train INFO: [Train]: [003][00030/00051] (59.6%)  Loss=1.2653  cls_loss=0.9466  reg_loss=0.3187  lr_backbone=7.2e-06  lr_det=7.2e-05  GPU=1441MB(alloc)/25434MB(reserved)/16157MB(max)  ETA=787s  iter_time=159.688s
2025-08-11 14:09:34 Train INFO: [Train]: [003][00035/00051] (69.2%)  Loss=1.2341  cls_loss=0.9215  reg_loss=0.3127  lr_backbone=7.4e-06  lr_det=7.4e-05  GPU=1441MB(alloc)/25434MB(reserved)/16157MB(max)  ETA=586s  iter_time=158.212s
2025-08-11 14:12:10 Train INFO: [Train]: [003][00040/00051] (78.8%)  Loss=1.2138  cls_loss=0.9024  reg_loss=0.3114  lr_backbone=7.6e-06  lr_det=7.6e-05  GPU=1441MB(alloc)/25434MB(reserved)/16157MB(max)  ETA=396s  iter_time=156.903s
2025-08-11 14:14:39 Train INFO: [Train]: [003][00045/00051] (88.5%)  Loss=1.1997  cls_loss=0.8883  reg_loss=0.3114  lr_backbone=7.8e-06  lr_det=7.8e-05  GPU=1441MB(alloc)/25434MB(reserved)/16157MB(max)  ETA=212s  iter_time=148.292s
2025-08-11 14:16:40 Train INFO: [Train]: [003][00050/00051] (98.1%)  Loss=1.1963  cls_loss=0.8826  reg_loss=0.3137  lr_backbone=8.0e-06  lr_det=8.0e-05  GPU=1441MB(alloc)/25434MB(reserved)/16157MB(max)  ETA=34s  iter_time=121.181s
2025-08-11 14:16:55 Train INFO: [Train]: [003][00051/00051] (100.0%)  Loss=1.1898  cls_loss=0.8772  reg_loss=0.3126  lr_backbone=8.0e-06  lr_det=8.0e-05  GPU=1403MB(alloc)/16898MB(reserved)/16157MB(max)  ETA=0s  iter_time=14.773s
2025-08-11 14:16:55 Train INFO: [Train]: Epoch 3 completed in 1761.5s (avg 33.874s/iter)
2025-08-11 14:16:55 Train INFO: [Train]: Final Loss=1.1898
2025-08-11 14:16:55 Train INFO: [Train]: Epoch 4 started (Total iterations: 52)
2025-08-11 14:29:04 Train INFO: [Train]: [004][00005/00051] (11.5%)  Loss=1.0570  cls_loss=0.7364  reg_loss=0.3205  lr_backbone=8.2e-06  lr_det=8.2e-05  GPU=1442MB(alloc)/24132MB(reserved)/16159MB(max)  ETA=5588s  iter_time=728.918s  fwd=34.944s/bwd=26.908s/opt=18.255s
2025-08-11 14:36:29 Train INFO: [Train]: [004][00010/00051] (21.2%)  Loss=1.0566  cls_loss=0.7380  reg_loss=0.3186  lr_backbone=8.4e-06  lr_det=8.4e-05  GPU=1442MB(alloc)/24132MB(reserved)/16159MB(max)  ETA=4373s  iter_time=444.282s
2025-08-11 14:43:51 Train INFO: [Train]: [004][00015/00051] (30.8%)  Loss=1.0525  cls_loss=0.7380  reg_loss=0.3145  lr_backbone=8.6e-06  lr_det=8.6e-05  GPU=1442MB(alloc)/24132MB(reserved)/16159MB(max)  ETA=3635s  iter_time=442.202s
2025-08-11 14:51:12 Train INFO: [Train]: [004][00020/00051] (40.4%)  Loss=1.0396  cls_loss=0.7267  reg_loss=0.3129  lr_backbone=8.8e-06  lr_det=8.8e-05  GPU=1442MB(alloc)/24132MB(reserved)/16159MB(max)  ETA=3036s  iter_time=441.457s
2025-08-11 14:58:34 Train INFO: [Train]: [004][00025/00051] (50.0%)  Loss=1.0445  cls_loss=0.7297  reg_loss=0.3148  lr_backbone=9.0e-06  lr_det=9.0e-05  GPU=1442MB(alloc)/24132MB(reserved)/16159MB(max)  ETA=2499s  iter_time=441.976s
2025-08-11 15:05:57 Train INFO: [Train]: [004][00030/00051] (59.6%)  Loss=1.0521  cls_loss=0.7353  reg_loss=0.3169  lr_backbone=9.2e-06  lr_det=9.2e-05  GPU=1442MB(alloc)/24132MB(reserved)/16159MB(max)  ETA=1992s  iter_time=442.287s
2025-08-11 15:13:19 Train INFO: [Train]: [004][00035/00051] (69.2%)  Loss=1.0520  cls_loss=0.7367  reg_loss=0.3154  lr_backbone=9.4e-06  lr_det=9.4e-05  GPU=1442MB(alloc)/24132MB(reserved)/16159MB(max)  ETA=1504s  iter_time=442.294s
2025-08-11 15:20:42 Train INFO: [Train]: [004][00040/00051] (78.8%)  Loss=1.0338  cls_loss=0.7244  reg_loss=0.3095  lr_backbone=9.6e-06  lr_det=9.6e-05  GPU=1442MB(alloc)/24132MB(reserved)/16159MB(max)  ETA=1027s  iter_time=442.775s
2025-08-11 15:27:49 Train INFO: [Train]: [004][00045/00051] (88.5%)  Loss=1.0348  cls_loss=0.7253  reg_loss=0.3096  lr_backbone=9.8e-06  lr_det=9.8e-05  GPU=1442MB(alloc)/24132MB(reserved)/16159MB(max)  ETA=555s  iter_time=427.619s
2025-08-11 15:34:38 Train INFO: [Train]: [004][00050/00051] (98.1%)  Loss=1.0328  cls_loss=0.7236  reg_loss=0.3093  lr_backbone=1.0e-05  lr_det=1.0e-04  GPU=1442MB(alloc)/24132MB(reserved)/16159MB(max)  ETA=91s  iter_time=408.426s
2025-08-11 15:36:01 Train INFO: [Train]: [004][00051/00051] (100.0%)  Loss=1.0327  cls_loss=0.7233  reg_loss=0.3094  lr_backbone=1.0e-05  lr_det=1.0e-04  GPU=1404MB(alloc)/24132MB(reserved)/16159MB(max)  ETA=0s  iter_time=83.612s
2025-08-11 15:36:02 Train INFO: [Train]: Epoch 4 completed in 4746.7s (avg 91.282s/iter)
2025-08-11 15:36:02 Train INFO: [Train]: Final Loss=1.0327
2025-08-11 15:36:02 Train INFO: [Train]: Epoch 5 started (Total iterations: 52)
2025-08-11 15:48:29 Train INFO: [Train]: [005][00005/00051] (11.5%)  Loss=0.9306  cls_loss=0.6538  reg_loss=0.2768  lr_backbone=1.0e-05  lr_det=1.0e-04  GPU=1442MB(alloc)/24132MB(reserved)/16159MB(max)  ETA=5722s  iter_time=746.386s  fwd=35.717s/bwd=27.625s/opt=18.817s
2025-08-11 15:56:01 Train INFO: [Train]: [005][00010/00051] (21.2%)  Loss=1.0540  cls_loss=0.7357  reg_loss=0.3182  lr_backbone=1.0e-05  lr_det=1.0e-04  GPU=1442MB(alloc)/24132MB(reserved)/16159MB(max)  ETA=4469s  iter_time=452.664s
2025-08-11 16:03:55 Train INFO: [Train]: [005][00015/00051] (30.8%)  Loss=1.0656  cls_loss=0.7416  reg_loss=0.3240  lr_backbone=1.0e-05  lr_det=1.0e-04  GPU=1442MB(alloc)/24132MB(reserved)/16159MB(max)  ETA=3765s  iter_time=474.156s
2025-08-11 16:12:01 Train INFO: [Train]: [005][00020/00051] (40.4%)  Loss=1.0483  cls_loss=0.7299  reg_loss=0.3184  lr_backbone=1.0e-05  lr_det=1.0e-04  GPU=1442MB(alloc)/24132MB(reserved)/16159MB(max)  ETA=3187s  iter_time=485.697s
2025-08-11 16:20:23 Train INFO: [Train]: [005][00025/00051] (50.0%)  Loss=1.0531  cls_loss=0.7335  reg_loss=0.3197  lr_backbone=1.0e-05  lr_det=1.0e-04  GPU=1442MB(alloc)/24132MB(reserved)/16159MB(max)  ETA=2661s  iter_time=502.018s
2025-08-11 16:28:33 Train INFO: [Train]: [005][00030/00051] (59.6%)  Loss=1.0401  cls_loss=0.7251  reg_loss=0.3150  lr_backbone=1.0e-05  lr_det=1.0e-04  GPU=1442MB(alloc)/24132MB(reserved)/16159MB(max)  ETA=2134s  iter_time=489.497s
2025-08-11 16:36:41 Train INFO: [Train]: [005][00035/00051] (69.2%)  Loss=1.0427  cls_loss=0.7274  reg_loss=0.3152  lr_backbone=1.0e-05  lr_det=1.0e-04  GPU=1442MB(alloc)/24132MB(reserved)/16159MB(max)  ETA=1617s  iter_time=488.521s
2025-08-11 16:44:53 Train INFO: [Train]: [005][00040/00051] (78.8%)  Loss=1.0403  cls_loss=0.7256  reg_loss=0.3148  lr_backbone=1.0e-05  lr_det=1.0e-04  GPU=1442MB(alloc)/24132MB(reserved)/16159MB(max)  ETA=1108s  iter_time=492.171s
2025-08-11 16:52:47 Train INFO: [Train]: [005][00045/00051] (88.5%)  Loss=1.0269  cls_loss=0.7171  reg_loss=0.3099  lr_backbone=1.0e-05  lr_det=1.0e-04  GPU=1442MB(alloc)/24132MB(reserved)/16159MB(max)  ETA=601s  iter_time=473.320s
